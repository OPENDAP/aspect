/-----------------------------------------------------------/
/ Instructions to build and run the Aspect brokering client /
/-----------------------------------------------------------/


--Step 1: Make sure you have libdap download and installed on your machine.
	o If you do not, follow the instructions here under section 3.4.1: Get and build libdap4 https://docs.opendap.org/index.php/Hyrax_GitHub_Source_Build#Compile_the_Hyrax_dependencies 
	o Additional packages (such as bison) may be required depending on your machine


--Step 2: Download the Aspect dependencies.
	o Follow the instructions on local installation in the Aspect manual (http://www.math.clemson.edu/~heister/manual.pdf) under section 3.3. STOP when you get to section 3.3.3 and go to Step 3 (downloading the brokering client requires a different link than the one in the manual)
		- Link for installation on MacOS X: https://github.com/geodynamics/aspect/wiki/Installing-and-running-ASPECT-on-Mac-OS-X
		  * If using the link for MacOS X installation, STOP when you get to step 4 in the link and instead continue following the instructions listed here


--Step 3: Download the Aspect client from https://github.com/OPENDAP/aspect.git.


--Step 4: Build the Aspect client.
	o Create a directory inside aspect called “build”
	o cd into the build directory
	o Inside the build directory run the command: 
	
		cmake .. -DLIBDAP_LIB=<libdap location>/build/lib -DLIBDAP_DIR=<libdap location>/build/include/libdap -DLIBDAP_ON=ON
		
			- Make sure to replace <libdap location> with the location of where libdap4 is on your computer
			- This creates an out-of-source build and also provides the location of the libdap libraries and directories that Aspect will need
			- LIBDAP_ON is used to determine if Aspect is running with the libdap packages installed. Using -DLIBDAP_ON=OFF will make the client go back to running without the libdap packaging (but not using libdap packages will make it impossible for Aspect to read data from a url)
				* The default value for LIBDAP_ON is OFF, so make sure you set it to ON if you wish to run Aspect with libdap
			
	o After you run the cmake command, make the client with the following command:
		make
			- Or "make -jN" if you have multiple processors in your machine, where N is the number of processors


--Step 5: Run the Aspect client.
	o To run Aspect type the following command:
		./aspect <prm file location>
			- There are many cookbook examples in Aspect, but to test the url reader part of the Aspect client you need to pass in a .prm file that uses a url
			- <prm file location> can be substituted with ../prm_files/aspect_url_test.prm
				* This prm file requests data from the lithospheric_thickness.csv file located on opendap test server at http://test.opendap.org/opendap/BALTO/contents.html
			
	o The Aspect client can read local files and files from a url
		- If you are writing a .prm file that will use data from a url, then you must set the Data directory to be blank and the Data file name to be the url of the requested data.
	
		Example: 
			subsection Initial temperature model
			   set Model name = adiabatic boundary
			subsection Ascii data model 
			    set Data directory    	= 
			 	set Data file name       = http://test.opendap.org/opendap/BALTO/lithospheric_thickness.csv
			end 
			end
